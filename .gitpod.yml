image: gitpod/workspace-postgres:2023-07-20-19-56-24

ports:
  - name: App
    port: 3000
    onOpen: notify
    visibility: public
    protocol: http

  - name: PostgreSQL
    port: 5432
    onOpen: ignore

  - name: RabbitMQ
    port: 5672
    onOpen: ignore

  - name: RabbitMQ Management
    port: 15672
    onOpen: ignore

  - name: Redis
    port: 6379
    onOpen: ignore

  - name: MailCrab
    port: 1025
    onOpen: ignore

  - name: MailCrab UI
    port: 1080
    onOpen: ignore

  - name: MinIO
    port: 9000
    onOpen: ignore

  - name: MinIO Console
    port: 9090
    onOpen: ignore

tasks:
  - command: |
      echo "127.0.0.1 s3.ap-southeast-3.amazonaws.com openmusic.s3.ap-southeast-3.amazonaws.com" | sudo tee -a /etc/hosts
      docker-compose  -f ./docker-compose.dev.yml up -d
  - init: |
      docker-compose pull
  - init: |
      nvm install
      npm install
